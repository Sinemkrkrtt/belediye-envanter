<!DOCTYPE html>
<html lang="tr">

<head>
  <meta charset="UTF-8" />
  <title>Ürün Giriş Sayfası</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background: linear-gradient(120deg, #f6f9fc, #e5eaf5);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 60px 20px;
    }

    .container {
      background: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.4);
      border-radius: 24px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      padding: 40px;
      width: 100%;
      max-width: 700px;
      animation: fadeIn 0.5s ease;
    }

    h1 {
      text-align: center;
      color: #cc0000;
      font-size: 28px;
      margin-bottom: 40px;
      font-weight: 700;
      letter-spacing: 1px;
    }

    .form-row {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
    }

    .column {
      flex: 1;
      min-width: 300px;
    }

    label {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 6px;
      display: block;
      color: #444;
      margin-top: 20px;
    }

    select,
    input[type="text"] {
      width: 100%;
      padding: 12px 15px;
      border: 1.5px solid #ccc;
      border-radius: 14px;
      font-size: 15px;
      transition: border 0.3s ease, box-shadow 0.3s ease;
      background-color: #fff;
    }

    select:focus,
    input[type="text"]:focus {
      border-color: #cc0000;
      box-shadow: 0 0 6px rgba(204, 0, 0, 0.3);
      outline: none;
    }

    .features-container {
      margin-top: 30px;
    }

    .bottom {
      margin-top: 40px;
      text-align: center;
    }

    .bottom button {
      background: #e60000;
      color: white;
      padding: 15px 40px;
      font-size: 16px;
      font-weight: 600;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 5px 12px rgba(230, 0, 0, 0.3);
    }

    .bottom button:hover {
      background-color: #c40000;
      transform: translateY(-2px);
    }

    @media (max-width: 768px) {
      .form-row {
        flex-direction: column;
      }

      .container {
        padding: 30px 20px;
      }

      h1 {
        font-size: 24px;
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>

<body>

  <div class="container">
    <h1>Ürün Giriş Sayfası</h1>

    <div class="form-row">
      <div class="column">
        <label for="product">Ürün Adı</label>
        <select id="product" onchange="updateBrands()">
          <option value="">Seçiniz</option>
          <option value="mouse">Mouse</option>
          <option value="monitor">Monitör</option>
          <option value="klavye">Klavye</option>
          <option value="pc">Bilgisayar</option>
          <option value="printer">Yazıcı</option>
          <option value="scanner">Tarayıcı</option>
          <option value="projector">Projeksiyon</option>
        </select>

        <label for="brand">Marka</label>
        <select id="brand" onchange="updateModels()">
          <option value="">Seçiniz</option>
        </select>

        <label for="model">Model</label>
        <select id="model" onchange="updateIPs()">
          <option value="">Seçiniz</option>
        </select>

        <label for="ip">IP Adresi</label>
        <select id="ip">
          <option value="">Seçiniz</option>
        </select>
      </div>
    </div>


    <div class="features-container">
      <label for="features">Ürün Özellikleri</label>
      <input type="text" id="features" placeholder="örn. Kablosuz, RGB, USB-C..." />
    </div>

    <div class="bottom">
      <button onclick="submitForm()">Kaydet</button>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, addDoc, setDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
    import { getDocs, query, where } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC6G7JfaTCSpvwkX4PXTTJ6I92LIpzkkxk",
      authDomain: "belediyeenvanter.firebaseapp.com",
      projectId: "belediyeenvanter",
      storageBucket: "belediyeenvanter.appspot.com",
      messagingSenderId: "1088833874170",
      appId: "1:1088833874170:web:2c2c1c069a9880917b8143"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const productBrandMap = {
      mouse: ["Logitech", "Razer", "Microsoft", "SteelSeries", "HP"],
      monitor: ["Samsung", "LG", "Acer", "Dell", "BenQ"],
      klavye: ["Corsair", "SteelSeries", "Logitech", "Razer", "Asus"],
      pc: ["Dell", "HP", "Asus", "Lenovo", "MSI"],
      printer: ["HP", "Canon", "Epson", "Brother", "Xerox"],
      scanner: ["Canon", "Epson", "Fujitsu", "HP", "Plustek"],
      projector: ["Epson", "BenQ", "Sony", "ViewSonic", "Optoma"]
    };

    const brandModelMap = {
      // Mouse
      Logitech: ["M185", "MX Master 3", "G Pro", "G502 Hero", "M720 Triathlon"],
      Razer: ["DeathAdder", "Naga", "Basilisk", "Viper Ultimate"],
      Microsoft: ["Sculpt", "Arc", "Basic Optical", "Modern Mobile"],
      SteelSeries: ["Rival 600", "Sensei Ten", "Aerox 3"],
      HP: ["X500", "Z3700", "OMEN Vector"],

      // Monitor
      Samsung: ["U28E590", "Odyssey G7", "Smart Monitor M8", "CRG9"],
      LG: ["27GN950", "Ultrafine", "32UN880", "34GN850"],
      Acer: ["Nitro VG270", "Predator XB3", "R240HY", "XV272U"],
      Dell: ["U2720Q", "P2419H", "S2721DGF"],
      BenQ: ["EX3501R", "PD3200U", "ZOWIE XL2546"],

      // Klavye
      Corsair: ["K70", "K95", "Strafe", "K60 Pro"],
      Razer: ["BlackWidow", "Huntsman", "Cynosa"],
      Asus: ["ROG Claymore", "TUF K3", "ROG Strix Scope"],

      // PC
      Dell: ["XPS 8930", "Inspiron 3880", "OptiPlex 7080", "Precision 3640"],
      HP: ["Pavilion", "EliteDesk", "Omen 30L", "ProDesk 400"],
      Asus: ["ROG Strix", "TUF Gaming", "VivoPC", "ExpertCenter"],
      Lenovo: ["ThinkCentre M720", "IdeaCentre 5", "Legion T5"],
      MSI: ["Trident 3", "Infinite A", "MEG Trident X"],

      // Printer
      Canon: ["PIXMA G6020", "imageCLASS MF445dw", "MAXIFY GX6020"],
      Epson: ["EcoTank L3150", "WorkForce WF-2850", "SureColor P600"],
      Brother: ["HL-L2350DW", "MFC-J995DW", "DCP-L2550DW"],
      Xerox: ["Phaser 6510", "WorkCentre 6515", "VersaLink B405"],

      // Scanner
      Fujitsu: ["ScanSnap iX1500", "fi-7160", "SP-1120"],
      Plustek: ["OpticSlim 1180", "SmartOffice PN2040", "Photo Scanner ePhoto Z300"],

      // Projector
      Epson: ["EH-TW7100", "EB-U42", "PowerLite 1781W"],
      Sony: ["VPL-VW295ES", "VPL-HW45ES", "MP-CD1"],
      ViewSonic: ["PX747-4K", "M1 Mini Plus", "PA503W"],
      Optoma: ["HD146X", "UHD50X", "GT1080HDR"]
    };

    const modelIpMap = {
      // Logitech
      "M185": ["192.168.1.101", "192.168.1.102"],
      "MX Master 3": ["192.168.1.103", "192.168.1.104"],
      "G502 Hero": ["192.168.1.105"],

      // Razer
      "DeathAdder": ["192.168.1.110", "192.168.1.111"],
      "Viper Ultimate": ["192.168.1.112"],

      // Microsoft
      "Sculpt": ["192.168.1.120"],
      "Arc": ["192.168.1.121", "192.168.1.122"],

      // Samsung Monitors
      "U28E590": ["192.168.1.201"],
      "Odyssey G7": ["192.168.1.202", "192.168.1.203"],
      "Smart Monitor M8": ["192.168.1.204"],

      // LG Monitors
      "27GN950": ["192.168.1.210"],
      "32UN880": ["192.168.1.211"],

      // Corsair Klavye
      "K70": ["192.168.1.301"],
      "K95": ["192.168.1.302"],

      // Dell PC
      "XPS 8930": ["192.168.1.401"],
      "OptiPlex 7080": ["192.168.1.402"],

      // HP PC
      "Omen 30L": ["192.168.1.410", "192.168.1.411"],

      // Printer
      "PIXMA G6020": ["192.168.1.501"],
      "EcoTank L3150": ["192.168.1.502"],
      "HL-L2350DW": ["192.168.1.503"],
      "Phaser 6510": ["192.168.1.504"],

      // Scanner
      "ScanSnap iX1500": ["192.168.1.601"],
      "OpticSlim 1180": ["192.168.1.602"],

      // Projector
      "EH-TW7100": ["192.168.1.701"],
      "PX747-4K": ["192.168.1.702"],
      "HD146X": ["192.168.1.703"]
    };


    const featuresInput = document.getElementById("features");
    featuresInput.addEventListener("input", async () => {
      const featureText = featuresInput.value;
      try {
        await setDoc(doc(db, "features_temp", "currentFeature"), {
          features: featureText,
          updatedAt: new Date()
        });
      } catch (e) {
        console.error("Özellik güncellenemedi:", e);
      }
    });

    window.updateBrands = function () {
      const product = document.getElementById("product").value;
      const brandSelect = document.getElementById("brand");
      const modelSelect = document.getElementById("model");
      const ipSelect = document.getElementById("ip");

      brandSelect.innerHTML = '<option value="">Seçiniz</option>';
      modelSelect.innerHTML = '<option value="">Seçiniz</option>';
      ipSelect.innerHTML = '<option value="">Seçiniz</option>';
      brandSelect.disabled = true;
      modelSelect.disabled = true;
      ipSelect.disabled = true;

      if (product && productBrandMap[product]) {
        productBrandMap[product].forEach(brand => {
          const option = document.createElement("option");
          option.value = brand;
          option.textContent = brand;
          brandSelect.appendChild(option);
        });
        brandSelect.disabled = false;
      }
    };

    window.updateModels = function () {
      const brand = document.getElementById("brand").value;
      const modelSelect = document.getElementById("model");
      const ipSelect = document.getElementById("ip");

      modelSelect.innerHTML = '<option value="">Seçiniz</option>';
      ipSelect.innerHTML = '<option value="">Seçiniz</option>';
      modelSelect.disabled = true;
      ipSelect.disabled = true;

      if (brand && brandModelMap[brand]) {
        brandModelMap[brand].forEach(model => {
          const option = document.createElement("option");
          option.value = model;
          option.textContent = model;
          modelSelect.appendChild(option);
        });
        modelSelect.disabled = false;
      }
    };

    window.updateIPs = function () {
      const model = document.getElementById("model").value;
      const ipSelect = document.getElementById("ip");

      ipSelect.innerHTML = '<option value="">Seçiniz</option>';
      ipSelect.disabled = true;

      if (model && modelIpMap[model]) {
        modelIpMap[model].forEach(ip => {
          const option = document.createElement("option");
          option.value = ip;
          option.textContent = ip;
          ipSelect.appendChild(option);
        });
        ipSelect.disabled = false;
      }
    };

    function normalize(str) {
      return (str ?? "").toString().trim().toLowerCase();
    }

    window.submitForm = async function () {
      const product = normalize(document.getElementById("product").value);
      const brand = normalize(document.getElementById("brand").value);
      const model = normalize(document.getElementById("model").value);
      const ip = normalize(document.getElementById("ip").value);

      const features = document.getElementById("features").value;

      if (!product || !brand || !model || !ip) {
        alert("Lütfen tüm alanları doldurun.");
        return;
      }

      try {
        const urunRef = collection(db, "urun_girisi");
        const q = query(
          urunRef,
          where("product", "==", product),
          where("brand", "==", brand),
          where("model", "==", model),
          where("ip", "==", ip)
        );

        const querySnapshot = await getDocs(q);

        if (!querySnapshot.empty) {
          const docRef = querySnapshot.docs[0].ref;
          const mevcutVeri = querySnapshot.docs[0].data();

          await setDoc(docRef, {
            ...mevcutVeri,
            product,
            brand,
            model,
            ip,
            features,
            adet: (mevcutVeri.adet || 0) + 1,
            timestamp: new Date()
          });

          alert("Ürün güncellendi.");
        } else {
          await addDoc(urunRef, {
            product,
            brand,
            model,
            ip,
            features,
            adet: 1,
            timestamp: new Date()
          });

          alert("Yeni ürün eklendi.");
        }


        location.reload();
      } catch (e) {
        alert("Hata oluştu: " + e.message);
      }
    };
  </script>
</body>

</html>